language: c
sudo: required
compiler:
  - clang
  - gcc
env:
  - DEBUG_MODE=1
  - DEBUG_MODE=0
before_install:
  - curl -sL https://deb.nodesource.com/setup_6.x | sudo -E bash -
  - sudo apt-get install -y nodejs
  - node -v
  - npm -v
before_script:
  - export DEBUG_SUFFIX=
  - if [ "$DEBUG_MODE" = "1" ]; then export DEBUG_SUFFIX=_debug; fi
script:
  - scons DEBUG=$DEBUG_MODE
  - cd machines/Node.js && npm install && npm test
  - python scripts/testsuite/test_programs.py DEBUG=$DEBUG_MODE